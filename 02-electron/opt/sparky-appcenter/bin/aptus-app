#!/bin/bash

# Application installer
# Copyright 2017-2019 Pawe≈Ç "pavroo" Pijanowski under GNU GPL 3
# Last update 2019/12/29 by pavroo

# get default's locale file
DEFLOCDIR="/usr/share/sparky/sparky-aptus-appcenter"
if [ "`cat /etc/default/locale | grep de`" != "" ]; then
. $DEFLOCDIR/de
elif [ "`cat /etc/default/locale | grep es`" != "" ]; then
. $DEFLOCDIR/es
elif [ "`cat /etc/default/locale | grep fr`" != "" ]; then
. $DEFLOCDIR/fr
elif [ "`cat /etc/default/locale | grep id_ID`" != "" ]; then
. $DEFLOCDIR/id_ID
elif [ "`cat /etc/default/locale | grep it`" != "" ]; then
. $DEFLOCDIR/it
elif [ "`cat /etc/default/locale | grep pl`" != "" ]; then
. $DEFLOCDIR/pl
elif [ "`cat /etc/default/locale | grep pt_BR`" != "" ]; then
. $DEFLOCDIR/pt_BR
elif [ "`cat /etc/default/locale | grep pt_PT`" != "" ]; then
. $DEFLOCDIR/pt_PT
else
. $DEFLOCDIR/en
fi

testroot="`whoami`"
if [ "$testroot" != "root" ]; then
	echo "Must be root... Exiting now..."
	exit 1
fi

#DIALOG="`which yad` --width=450 --height=250 --window-icon=system-software-install --image=system-software-install --center"
DIALOG="`which yad` --width=450 --height=250 --image=system-software-install --center --undecorated --skip-taskbar --borders=20"
TEXT="--text="
TITLE="--title="
OKEXIT="--button=Ok:0 --button=$LOCAL001:1"
MSGBOX="--button=Ok:0"
BUTTONREMOVE="--button=$LOCAL008:3"
BUTTONREINSTALL="--button=$LOCAL009:4"
BUTTONINSTALL="--button=$LOCAL010:0"
BUTTONEXIT="--button=$LOCAL001:1"
TITLETEXT="APTus AppCenter"
PINGTEST=$(ping -c 1 debian.org | grep [0-9])
WORKDIR="/tmp/sparky-appcenter"
SERVERG="https://dl.google.com/linux/direct"
PACKG64="google-chrome-stable_current_amd64.deb"
SERVERE="https://dl.google.com/dl/earth/client/current"
PACKE32="google-earth-pro-stable_current_i386.deb"
PACKE64="google-earth-pro-stable_current_amd64.deb"
SERVER64SKYPE="https://go.skype.com"
PACK64SKYPE="skypeforlinux-64.deb"
TESTTILDA=`which tilda`
TILDAVER=`dpkg-query -l | grep tilda | grep 1.3`
if [ "$TESTTILDA" != "" ]; then
	if [ "$TILDAVER" != "" ]; then
		SPARKYXTERM="$TESTTILDA -c"
	elif [ "$TILDAVER" = "" ]; then
		SPARKYXTERM="$TESTTILDA -g /etc/sparky-aptus-appcenter/tilda-config0 -c"
	fi
elif [ -f /usr/bin/xterm ]; then
	SPARKYXTERM="xterm -e"
elif [ -f /usr/bin/x-terminal-emulator ]; then
	SPARKYXTERM="x-terminal-emulator -e"
else
	echo "x terminal emulator is missing... exiting..."
	exit 1
fi
INSTALL="apt-get install"
REINSTALL="apt-get install --reinstall"
UNINSTALL="apt-get purge"
UPDATE="apt-get update"
APTKEY="apt-key"
ARCH64="`uname -m | grep x86_64`"
ARCH32="`uname -m | grep 686`"
ARCHARM="`uname -m | grep arm`"
# checking Sparky 4/5/6
SPARKYVERCHECK6="`cat /etc/os-release | grep Tolo`"
SPARKYVERCHECK5="`cat /etc/os-release | grep Nibiru`"
SPARKYVERCHECK4="`cat /etc/os-release | grep Tyche`"

##### graphics editors #####
if [ "$1" = "darktable" ]; then
	if [ "$ARCH32" != "" ] || [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "lightzone" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "opentoonz" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "xnview" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"

##### multimedia audio players #####
elif [ "$1" = "deadbeef" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "deepin-music" ]; then
	if [ "$SPARKYVERCHECK4" != "" ] || [ "$DEBIANVERCHECK9" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL006\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "pragha" ]; then
	if [ "$SPARKYVERCHECK4" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL006\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "sayonara" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "spotify-client" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "yarock" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"

##### multimedia burners #####
elif [ "$1" = "kylin-burner" ]; then
	if [ "$SPARKYVERCHECK4" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL006\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"

##### multimedia video players #####
elif [ "$1" = "motionbox" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "rage" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"

##### office text #####
elif [ "$1" = "atom" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL006\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "featherpad" ]; then
	if [ "$SPARKYVERCHECK4" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL006\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "notepadqq" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"

##### office suite #####
elif [ "$1" = "softmaker-freeoffice-2018" ]; then
	if [ "$ARCHARM" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "libreoffice" ]; then
	# check is OpenOffice installed
	CHECKOO=`apt-cache policy openoffice | head -n2 | tail -n1 | grep [0-9]`
	if [ "$CHECKOO" != "" ]; then
		$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL026\n\n$LOCAL005"
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "openoffice" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	# check is LibreOffice installed
	if [ -f /usr/bin/libreoffice ]; then
		$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL025\n\n$LOCAL005"
		exit 1
	fi
	PACKAGE="$1"
	OOPACKAGES="openoffice-brand-en-us openoffice-brand-writer openoffice-brand-calc openoffice-brand-impress openoffice-brand-base openoffice-brand-draw openoffice-brand-math openoffice-pyuno openoffice-ooofonts openoffice-ooolinguistic openoffice-debian-menus"
elif [ "$1" = "wps-office" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
	WPSPACKAGES="wps-office-fonts"

##### web communication #####
elif [ "$1" = "caprine" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "discord" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "franz" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "skypeforlinux" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "telegram-desktop" ]; then
	if [ "$SPARKYVERCHECK4" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL006\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "tor-messenger" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"

##### web others #####
elif [ "$1" = "dropbox" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "google-earth-pro-stable" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
	if [ "$ARCH64" != "" ]; then
		PACKEARTH="$PACKE64"
	else
		#PACKEARTH="$PACKE32"
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
elif [ "$1" = "megasync" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "spideroakone" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"

##### web browsers #####
elif [ "$1" = "brave" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "cyberfox" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "dooble" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "falkon" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "firefox-latest" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	if [ "$SPARKYVERCHECK4" != "" ] || [ "$SPARKYVERCHECK5" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL006\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="firefox"
elif [ "$1" = "google-chrome-stable" ]; then
	if [ "$ARCH64" = "" ]; 	then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "icecat" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "iridium-browser" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "iron" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "min" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "netsurf" ]; then
	if [ "$SPARKYVERCHECK4" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL016\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "opera-stable" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "seamonkey" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "tor-browser" ]; then
	if [ "$ARCHARM" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL007\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
elif [ "$1" = "waterfox" ]; then
	if [ "$ARCH64" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL004\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
		exit 1
	fi
	PACKAGE="$1"
else
	PACKAGE="$1"
fi

CHECKPACKAGE0=`apt-cache policy $PACKAGE | head -n2 | tail -n1 | grep [0-9]`
# install, reinstall or remove discord
if [ "$1" = "discord" ]; then
	if [ "$CHECKPACKAGE0" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL011\n$LOCAL012" $TITLE"$TITLETEXT" $BUTTONREMOVE $BUTTONREINSTALL $BUTTONEXIT
		ret=$?
		if [[ $ret -eq 3 ]]; then
			$SPARKYXTERM "$UNINSTALL $PACKAGE"
		elif [[ $ret -eq 4 ]]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM `wget -O discord.deb "https://discordapp.com/api/download?platform=linux&format=deb"`
			$SPARKYXTERM "$INSTALL ./discord.deb"
			rm -rf $WORKDIR
		else
			exit 1
		fi
	elif [ "$CHECKPACKAGE0" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL014" $TITLE"$TITLETEXT" $BUTTONINSTALL $BUTTONEXIT
		if [ "$?" = "0" ]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL014"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM `wget -O discord.deb "https://discordapp.com/api/download?platform=linux&format=deb"`
			$SPARKYXTERM "$INSTALL ./discord.deb"
			rm -rf $WORKDIR
			CHECKPACKAGE1=`apt-cache policy $PACKAGE | head -n2 | tail -n1 | grep [0-9]`
			if [ "$CHECKPACKAGE1" = "" ]; then
				$DIALOG $TEXT"\n$LOCAL013\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			else
				$DIALOG $TEXT"\n$LOCAL015\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			fi

		elif [ "$?" != "0" ]; then
			exit 1
		fi
	fi

# install, reinstall or remove google-chrome
elif [ "$1" = "google-chrome-stable" ]; then
	if [ "$CHECKPACKAGE0" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL011\n$LOCAL012" $TITLE"$TITLETEXT" $BUTTONREMOVE $BUTTONREINSTALL $BUTTONEXIT
		ret=$?
		if [[ $ret -eq 3 ]]; then
			$SPARKYXTERM "$UNINSTALL $PACKAGE"
		elif [[ $ret -eq 4 ]]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM "wget $SERVERG/$PACKG64"
			$SPARKYXTERM "$INSTALL ./$PACKG64"
			rm -rf $WORKDIR
		else
			exit 1
		fi
	elif [ "$CHECKPACKAGE0" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL014" $TITLE"$TITLETEXT" $BUTTONINSTALL $BUTTONEXIT
		if [ "$?" = "0" ]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL014"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM "wget $SERVERG/$PACKG64"
			$SPARKYXTERM "$INSTALL ./$PACKG64"
			rm -rf $WORKDIR
			CHECKPACKAGE1=`apt-cache policy $PACKAGE | head -n2 | tail -n1 | grep [0-9]`
			if [ "$CHECKPACKAGE1" = "" ]; then
				$DIALOG $TEXT"\n$LOCAL013\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			else
				$DIALOG $TEXT"\n$LOCAL015\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			fi

		elif [ "$?" != "0" ]; then
			exit 1
		fi
	fi

# install, reinstall or remove google-earth
elif [ "$1" = "google-earth-pro-stable" ]; then
	if [ "$CHECKPACKAGE0" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL011\n$LOCAL012" $TITLE"$TITLETEXT" $BUTTONREMOVE $BUTTONREINSTALL $BUTTONEXIT
		ret=$?
		if [[ $ret -eq 3 ]]; then
			$SPARKYXTERM "$UNINSTALL $PACKAGE"
		elif [[ $ret -eq 4 ]]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM "wget $SERVERE/$PACKEARTH"
			$SPARKYXTERM "$INSTALL ./$PACKEARTH"
			rm -rf $WORKDIR
		else
			exit 1
		fi
	elif [ "$CHECKPACKAGE0" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL014" $TITLE"$TITLETEXT" $BUTTONINSTALL $BUTTONEXIT
		if [ "$?" = "0" ]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL014"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM "wget $SERVERE/$PACKEARTH"
			$SPARKYXTERM "$INSTALL ./$PACKEARTH"
			rm -rf $WORKDIR
			CHECKPACKAGE1=`apt-cache policy $PACKAGE | head -n2 | tail -n1 | grep [0-9]`
			if [ "$CHECKPACKAGE1" = "" ]; then
				$DIALOG $TEXT"\n$LOCAL013\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			else
				$DIALOG $TEXT"\n$LOCAL015\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			fi

		elif [ "$?" != "0" ]; then
			exit 1
		fi
	fi

# install, reinstall or remove openoffice.org
elif [ "$1" = "openoffice" ]; then
	if [ "$CHECKPACKAGE0" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL011\n$LOCAL012" $TITLE"$TITLETEXT" $BUTTONREMOVE $BUTTONREINSTALL $BUTTONEXIT
		ret=$?
		if [[ $ret -eq 3 ]]; then
			$SPARKYXTERM "$UNINSTALL $PACKAGE $OOPACKAGES"
		elif [[ $ret -eq 4 ]]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			$SPARKYXTERM "$INSTALL $OOPACKAGES"
		else
			exit 1
		fi
	elif [ "$CHECKPACKAGE0" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL014" $TITLE"$TITLETEXT" $BUTTONINSTALL $BUTTONEXIT
		if [ "$?" = "0" ]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL014"
				exit 1
			fi
			if [ -f /etc/apt/sources.list.d/openoffice.list ]; then
				rm -f /etc/apt/sources.list.d/openoffice.list
			fi
cat > /etc/apt/sources.list.d/openoffice.list <<FOO
# Unofficial OpenOffice repository for Debian
deb http://downloads.sourceforge.net/project/apacheoo-deb/debian testing main
FOO
			# install keyring
			$SPARKYXTERM "$APTKEY adv --keyserver keys.gnupg.net --recv-keys 90127F5B"
			$SPARKYXTERM "$UPDATE"
			$SPARKYXTERM "$INSTALL $OOPACKAGES"
			CHECKPACKAGE1=`apt-cache policy $PACKAGE | head -n2 | tail -n1 | grep [0-9]`
			if [ "$CHECKPACKAGE1" = "" ]; then
				$DIALOG $TEXT"\n$LOCAL013\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			else
				$DIALOG $TEXT"\n$LOCAL015\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			fi

		elif [ "$?" != "0" ]; then
			exit 1
		fi
	fi

# install, reinstall or remove skype
elif [ "$1" = "skype" ]; then
	if [ "$CHECKPACKAGE0" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL011\n$LOCAL012" $TITLE"$TITLETEXT" $BUTTONREMOVE $BUTTONREINSTALL $BUTTONEXIT
		ret=$?
		if [[ $ret -eq 3 ]]; then
			$SPARKYXTERM "$UNINSTALL $PACKAGE"
		elif [[ $ret -eq 4 ]]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM "wget $SERVER64SKYPE/$PACK64SKYPE"
			$SPARKYXTERM "$INSTALL ./$PACK64SKYPE"
			rm -rf $WORKDIR
		else
			exit 1
		fi
	elif [ "$CHECKPACKAGE0" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL014" $TITLE"$TITLETEXT" $BUTTONINSTALL $BUTTONEXIT
		if [ "$?" = "0" ]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL014"
				exit 1
			fi
			rm -rf $WORKDIR
			mkdir -p $WORKDIR
			cd $WORKDIR
			$SPARKYXTERM "wget $SERVER64SKYPE/$PACK64SKYPE"
			$SPARKYXTERM "$INSTALL ./$PACK64SKYPE"
			rm -rf $WORKDIR
			CHECKPACKAGE1=`apt-cache policy $PACKAGE | head -n2 | tail -n1 | grep [0-9]`
			if [ "$CHECKPACKAGE1" = "" ]; then
				$DIALOG $TEXT"\n$LOCAL013\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			else
				$DIALOG $TEXT"\n$LOCAL015\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			fi

		elif [ "$?" != "0" ]; then
			exit 1
		fi
	fi

# install, reinstall or remove wps-office
elif [ "$1" = "wps-office" ]; then
	if [ -f /usr/bin/wps ]; then
		$DIALOG $TEXT"\n$LOCAL011\n$LOCAL012" $TITLE"$TITLETEXT" $BUTTONREMOVE $BUTTONREINSTALL $BUTTONEXIT
		ret=$?
		if [[ $ret -eq 3 ]]; then
			$SPARKYXTERM "$UNINSTALL $PACKAGE $WPSPACKAGES"
		elif [[ $ret -eq 4 ]]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			$SPARKYXTERM "$INSTALL $PACKAGE $WPSPACKAGES"
		else
			exit 1
		fi
	elif [ ! -f /usr/bin/wps ]; then
		$DIALOG $TEXT"\n$LOCAL014" $TITLE"$TITLETEXT" $BUTTONINSTALL $BUTTONEXIT
		if [ "$?" = "0" ]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL014"
				exit 1
			fi
			$SPARKYXTERM "$INSTALL $PACKAGE $WPSPACKAGES"
			if [ ! -f /usr/bin/wps ]; then
				$DIALOG $TEXT"\n$LOCAL013\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			else
				$DIALOG $TEXT"\n$LOCAL015\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			fi

		elif [ "$?" != "0" ]; then
			exit 1
		fi
	fi

# install, reinstall or remove anything else
else
	if [ "$CHECKPACKAGE0" != "" ]; then
		$DIALOG $TEXT"\n$LOCAL011\n$LOCAL012" $TITLE"$TITLETEXT" $BUTTONREMOVE $BUTTONREINSTALL $BUTTONEXIT
		ret=$?
		if [[ $ret -eq 3 ]]; then
			$SPARKYXTERM "$UNINSTALL $PACKAGE"
		elif [[ $ret -eq 4 ]]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			$SPARKYXTERM "$REINSTALL $PACKAGE"
		else
			exit 1
		fi
	elif [ "$CHECKPACKAGE0" = "" ]; then
		$DIALOG $TEXT"\n$LOCAL014" $TITLE"$TITLETEXT" $BUTTONINSTALL $BUTTONEXIT
		if [ "$?" = "0" ]; then
			if [ "$PINGTEST" = "" ]; then
				$DIALOG $TITLE"$TITLETEXT" $MSGBOX $TEXT"$LOCAL003 \n\n$LOCAL005"
				exit 1
			fi
			$SPARKYXTERM "$INSTALL $PACKAGE"
			CHECKPACKAGE1=`apt-cache policy $PACKAGE | head -n2 | tail -n1 | grep [0-9]`
			if [ "$CHECKPACKAGE1" = "" ]; then
				$DIALOG $TEXT"\n$LOCAL013\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			else
				$DIALOG $TEXT"\n$LOCAL015\n\n$LOCAL005" $TITLE"$TITLETEXT" $MSGBOX
				exit 1
			fi

		elif [ "$?" != "0" ]; then
			exit 1
		fi
	fi
fi

exit 0
